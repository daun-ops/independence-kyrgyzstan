<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–° –î–Ω–µ–º –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Rubik:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body, html {
      margin: 0; padding: 0; height: 100%; overflow: hidden;
      font-family: 'Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #d80027; /* –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω –∫–∞–∫ —É —Ñ–ª–∞–≥–∞ –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º */
    }
    /* –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∞–∑–ª—ë—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ */
    @keyframes flyAway {
      0% {
        transform: translate(0,0) rotate(0) scale(1);
        opacity: 1;
        filter: blur(0px);
      }
      100% {
        transform: translate(var(--tx, 0px), var(--ty, -120vh)) rotate(var(--rz, 40deg)) scale(0.8);
        opacity: 0;
        filter: blur(3px);
      }
    }
    .disperse {
      will-change: transform, opacity, filter;
      animation: flyAway 900ms ease-in forwards;
    }
    @keyframes wave {
      0% { background-position: 50% 50%; }
      50% { background-position: 52% 48%; }
      100% { background-position: 50% 50%; }
    }
    .overlay {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      z-index: 1;
    }
    /* –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º overlay –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –≤–º–µ—Å—Ç–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (—É–º–µ–Ω—å—à–∞–µ—Ç –º–µ—Ä—Ü–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª–µ) */
    .overlay-fadeout {
      opacity: 0;
      transition: opacity 400ms ease;
    }
    /* –°–ª–æ–π —Ñ–ª–∞–≥–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π ¬´—Ä–∞–∑–≤–µ–≤–∞–Ω–∏—è¬ª */
    .flag {
      position: fixed; inset: 0;
      background-color: #d80027; /* –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è */
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Flag_of_Kyrgyzstan.svg/1920px-Flag_of_Kyrgyzstan.svg.png');
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      z-index: 0;
      transform-origin: left center;
      filter: saturate(1.05) brightness(1.03);
      animation: flagWave 6s ease-in-out infinite;
      /* —Å–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π —Å–ª–æ–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏–π –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
      backface-visibility: hidden;
      transform: translateZ(0);
      will-change: transform;
    }
    .flag::after {
      content: "";
      position: absolute; inset: 0;
      /* –ü–æ–¥–≤–∏–∂–Ω—ã–µ –±–ª–∏–∫–∏/—Ç–µ–Ω–∏, —Å–æ–∑–¥–∞—é—â–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–∫–ª–∞–¥–æ–∫ */
      background: linear-gradient(
        to right,
        rgba(255,255,255,0.10) 0%,
        rgba(0,0,0,0.00) 20%,
        rgba(0,0,0,0.10) 50%,
        rgba(0,0,0,0.00) 80%,
        rgba(255,255,255,0.08) 100%
      );
      background-size: 160px 100%;
      mix-blend-mode: overlay;
      pointer-events: none;
      animation: waveLight 3s linear infinite;
      opacity: 0.55;
    }
    @keyframes flagWave {
      0%   { transform: perspective(900px) rotateY(0.8deg) skewY(0.6deg) scaleY(1.00); }
      50%  { transform: perspective(900px) rotateY(-2deg)  skewY(-1.2deg) scaleY(1.02) translateX(-6px); }
      100% { transform: perspective(900px) rotateY(0.8deg) skewY(0.6deg) scaleY(1.00); }
    }
    /* –û–±–ª–µ–≥—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Ñ–ª–∞–≥–∞ –¥–ª—è —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ */
    @keyframes flagWaveLite {
      0%   { transform: perspective(900px) rotateY(0.12deg) skewY(0.10deg) scaleY(1.00); }
      50%  { transform: perspective(900px) rotateY(-0.24deg) skewY(-0.16deg) scaleY(1.005); }
      100% { transform: perspective(900px) rotateY(0.12deg) skewY(0.10deg) scaleY(1.00); }
    }
    @keyframes waveLight {
      from { background-position: 0 0; }
      to   { background-position: 320px 0; }
    }
    /* –£—á–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–º–µ–Ω—å—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; }
      .flag { animation: none !important; }
      .flag::after { animation: none !important; }
    }
    .text-container {
      text-align: center;
      color: #fff;
      padding: 1rem;
      background: rgba(0,0,0,0.4);
      border-radius: 1rem;
      animation: glow 2.5s infinite alternate;
      position: relative;
      z-index: 2;
    }
    .text-container h1,
    .text-container h2 {
      font-family: 'Lobster', 'Rubik', sans-serif;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }
    @keyframes glow {
      from { box-shadow: 0 0 10px rgba(255, 215, 0, 0.7), 0 0 20px rgba(255, 0, 0, 0.6); }
      to { box-shadow: 0 0 25px rgba(255, 255, 0, 1), 0 0 50px rgba(255, 0, 0, 0.9); }
    }
    .confetti {
      position: fixed;
      width: 10px; height: 10px;
      background-color: red;
      top: -10px;
      animation: fall linear forwards;
    }
    @keyframes fall {
      to { transform: translateY(110vh) rotate(360deg); }
    }
    .firework {
      position: fixed;
      /* –ï—â—ë –º–µ–Ω—å—à–∏–µ —á–∞—Å—Ç–∏—Ü—ã, —Ö–≤–æ—Å—Ç—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
      width: 6px; height: 6px;
      background: yellow;
      border-radius: 50%;
      box-shadow: 0 0 18px rgba(255,255,150,0.9), 0 0 36px rgba(255,100,0,0.7);
      animation: moveexplode 1.8s ease-out forwards;
    }
    /* –°–≤–µ—Ç—è—â–∏–π—Å—è —Ö–≤–æ—Å—Ç –≤–¥–æ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—ë—Ç–∞ */
    .firework::after {
      content: "";
      position: absolute;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%) rotate(var(--angle, 0rad));
      width: var(--tail, 120px);
      height: 3px;
      background: linear-gradient(90deg, rgba(255,255,255,0.0) 0%, rgba(255,255,150,0.85) 60%, rgba(255,120,0,0.0) 100%);
      filter: blur(1px);
      opacity: 0.9;
      border-radius: 2px;
      pointer-events: none;
    }
    @keyframes moveexplode {
      0% { transform: translate(0, 0) scale(0.3); opacity: 1; }
      70% { transform: translate(var(--dx, 0), var(--dy, 0)) scale(2.5); opacity: 1; }
      100% { transform: translate(calc(var(--dx, 0) * 1.05), calc(var(--dy, 0) * 1.05)) scale(3.5); opacity: 0; }
    }
    /* –ê–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂: —Ü–µ–Ω—Ç—Ä —ç–∫—Ä–∞–Ω–∞ */
    .character {
      position: fixed;
      left: 50%; top: 50%;
      width: min(30vw, 260px);
      height: auto;
      z-index: 2; /* –Ω–∞–¥ overlay (1) –∏ —Ñ–ª–∞–≥–æ–º (0), –ø–æ–¥ —Ç–µ–∫—Å—Ç–æ–º (2/3) */
      pointer-events: none;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,0.6));
      transform: translate(-50%, -50%) scale(0.94);
      will-change: transform, opacity;
    }
    /* –ü–æ—è–≤–∏—Ç—å—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ –∏ –∏—Å—á–µ–∑–Ω—É—Ç—å */
    @keyframes popInOut {
      0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.92); }
      12%  { opacity: 1; transform: translate(-50%, -50%) scale(1.00); }
      75%  { opacity: 1; transform: translate(-50%, -50%) scale(1.00); }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(0.98); }
    }
    .character-pop {
      animation: popInOut 3.2s ease-out forwards;
    }
    /* –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: –¥–æ 480px */
    @media (max-width: 480px) {
      .character { width: 46vw; }
      .text-container { padding: 0.75rem; border-radius: 0.75rem; }
      .text-container h1 { font-size: 1.6rem; }
      .text-container h2 { font-size: 1.1rem; }
      .cta-btn { padding: 0.8rem 1.2rem; font-size: 1rem; }
      /* –ù–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö –æ—Ç–∫–ª—é—á–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Ñ–æ–Ω–∞ —Å —Ñ–ª–∞–≥–æ–º */
      .flag { animation: none !important; }
      .flag::after { animation: none !important; opacity: 0.15; }
    }
    /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏-–ø—Ä–∏–∑—ã–≤–∞ –∫ –¥–µ–π—Å—Ç–≤–∏—é */
    .cta-btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      padding: 1rem 1.6rem;
      border: 0;
      border-radius: 9999px;
      background: linear-gradient(135deg, #4f9cff 0%, #3a84f9 50%, #2f6df6 100%);
      color: #ffffff !important;
      font-weight: 900;
      font-size: 1.1rem;
      text-decoration: none !important;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      text-shadow: none;
      box-shadow: 0 2px 8px rgba(0, 64, 160, 0.25);
      border: 1px solid rgba(255,255,255,0.12);
      transition: transform .15s ease, box-shadow .15s ease, filter .15s ease, opacity .15s ease;
      animation: none;
      cursor: pointer;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .cta-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 64, 160, 0.28);
      filter: brightness(1.04) saturate(1.02);
    }
    .cta-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(0, 64, 160, 0.22);
    }
    .cta-btn:focus-visible {
      outline: none;
      box-shadow: 0 0 0 4px rgba(59,130,246,0.35), 0 8px 16px rgba(0, 64, 160, 0.25);
    }
    /* –ë–ª–∏–∫ –∏ –≥–ª—è–Ω–µ—Ü */
    .cta-btn::before, .cta-btn::after { content: none; }
    @keyframes shine {
      0% { transform: translateX(-120%) rotate(12deg); }
      40%, 100% { transform: translateX(220%) rotate(12deg); }
    }
    @keyframes pulseSoft {
      0%, 100% {
        box-shadow: 0 10px 25px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.55);
      }
      50% {
        box-shadow: 0 14px 32px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.6);
      }
    }
  </style>
</head>
<body class="flex items-center justify-center">

  <div class="flag"></div>
  <div class="overlay"></div>
  <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂ (—Å–∫—Ä—ã—Ç, –ø–æ–∫–∞ –Ω–µ –∑–∞–¥–∞–Ω URL) -->
  <img id="character" class="character" alt="–ê–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂" style="display:none" />

  <div class="text-container animate-scaleIn">
    <h1 class="text-4xl md:text-6xl font-bold animate-fadeInUp">
      –° –î–ù–Å–ú –ù–ï–ó–ê–í–ò–°–ò–ú–û–°–¢–ò
    </h1>
    <h2 class="text-2xl md:text-4xl mt-4 animate-scaleIn">
      –ö–´–†–ì–´–ó–°–¢–ê–ù–ê üá∞üá¨
    </h2>
    <button id="startBtn" type="button" aria-label="–ù–∞—á–∞—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫" class="cta-btn mt-6 text-base md:text-xl">
      –Ω–∞—á–∞—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫ üéâ
    </button>
  </div>

  <script>
    // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (PNG) —Å GitHub (raw URL)
    const characterUrl = 'https://raw.githubusercontent.com/daun-ops/independence-kyrgyzstan/7d002ab4dc2fe7dbd35a1d24f54b7a60d1f7c019/MVD.png';
    const characterEl = document.getElementById('character');
    if (characterEl && characterUrl) {
      characterEl.src = characterUrl; // –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ä–∞–∑—É, –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
    }

    // –ó–≤—É–∫–∏ —Ñ–∞–Ω—Ñ–∞—Ä + —Å–∞–ª—é—Ç
    // –ê—É–¥–∏–æ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitHub (raw URL –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç)
    const githubFanfareUrl = "https://raw.githubusercontent.com/daun-ops/independence-kyrgyzstan/6377855f91cc90fb7f1f7a8e5eda7b3205aeeb9e/arab.mp3";
    const fanfare = new Audio(githubFanfareUrl);
    const fireworkSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_b99d9b76a1.mp3?filename=firework-explosion-6962.mp3");
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞–ª–µ–Ω—å–∫–∏–π —ç–∫—Ä–∞–Ω (—Å–º–∞—Ä—Ç—Ñ–æ–Ω)
    const isSmallScreen = window.matchMedia && window.matchMedia('(max-width: 480px)').matches;
    fanfare.preload = "auto"; fanfare.load();
    fireworkSound.preload = "auto"; fireworkSound.load();
    fanfare.volume = isSmallScreen ? 0.45 : 0.6;
    fireworkSound.volume = isSmallScreen ? 0.45 : 0.6;
    // –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤ —á–∞—Å—Ç–∏—Ü —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∞ (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ–¥ –≤–∫—É—Å)
    const FIREWORK_COLORS = [
      '#0b20de',
      '#db0b1c',
      '#f05a0a',
      '#f05a0a'
    ];

    let started = false;
    let fireworkInterval;
    let musicFireworkInterval;
    let musicBigBoomInterval;

    const startBtn = document.getElementById('startBtn');
    if (startBtn) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º pointerup –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö
      startBtn.addEventListener('pointerup', startCelebration, { once: true });
      // –§–æ–ª–±—ç–∫ –Ω–∞ click –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤/–ø–ª–∞—Ç—Ñ–æ—Ä–º
      startBtn.addEventListener('click', startCelebration, { once: true });
      // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (Enter/Space)
      startBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          startCelebration();
        }
      }, { once: true });
    }

    function startCelebration() {
      if (started) return;
      started = true; // —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å—Ç–∞—Ä—Ç, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–≤–æ–π–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

      // –í–∏–±—Ä–æ-–æ—Ç–∫–ª–∏–∫
      if (navigator.vibrate) { try { navigator.vibrate([120, 60, 120]); } catch(_) {} }

      // –ó–∞–ø—É—Å—Ç–∏—Ç—å –º—É–∑—ã–∫—É –∏ —Å–∞–ª—é—Ç—ã (–∫–æ–Ω—Ñ–µ—Ç—Ç–∏ —É–∂–µ –∏–¥—ë—Ç)
      try { fanfare.currentTime = 0; fanfare.play().catch(()=>{}); } catch(_) {}
      createFirework(); // –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–µ—Ä–≤—ã–π –∑–∞–ª–ø
      try { fireworkSound.currentTime = 0; fireworkSound.play().catch(()=>{}); } catch(_) {}
      // –ë–∞–∑–æ–≤—ã–π —Ç–µ–º–ø –∑–∞–ª–ø–æ–≤ (–±—É–¥–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω —Å–ª—É—à–∞—Ç–µ–ª–µ–º fanfare.play)
      fireworkInterval = setInterval(() => {
        createFirework();
        if (navigator.vibrate) { try { navigator.vibrate(80); } catch(_) {} }
        try { fireworkSound.currentTime = 0; fireworkSound.play().catch(()=>{}); } catch(_) {}
      }, isSmallScreen ? 6000 : 4000);

      // –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∫ —Ä–∞–∑–ª—ë—Ç—É: —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ (overlay –Ω–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º ‚Äî —Ç–æ–ª—å–∫–æ –ø–ª–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º)
      const toDisperse = [];
      const textBlock = document.querySelector('.text-container'); if (textBlock) toDisperse.push(textBlock);
      // –ü–µ—Ä—Å–æ–Ω–∞–∂–∞ –ù–ï —Ä–∞–∑–ª–µ—Ç–∞–µ–º ‚Äî –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
      const overlay = document.querySelector('.overlay');
      if (startBtn) toDisperse.push(startBtn);

      toDisperse.forEach((el, idx) => {
        // –°–ª—É—á–∞–π–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è/—É–≥–ª—ã
        const angle = Math.random() * Math.PI * 2;
        const dist = 200 + Math.random() * 600; // px
        const tx = Math.cos(angle) * dist;
        const ty = Math.sin(angle) * dist - window.innerHeight * 0.4; // –≤–≤–µ—Ä—Ö –∑–∞ —ç–∫—Ä–∞–Ω
        const rz = (Math.random() * 80 - 40) + 'deg';
        el.style.setProperty('--tx', tx + 'px');
        el.style.setProperty('--ty', ty + 'px');
        el.style.setProperty('--rz', rz);
        el.classList.add('disperse');
      });

      // –ü–ª–∞–≤–Ω–æ —Å–∫—Ä—ã—Ç—å overlay –±–µ–∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (–±–æ—Ä—å–±–∞ —Å –º–µ—Ä—Ü–∞–Ω–∏–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—ë–≤)
      if (overlay) {
        // –§–æ—Ä—Å–∏–º reflow —á–µ—Ä–µ–∑ rAF, —á—Ç–æ–±—ã transition —Å—Ä–∞–±–æ—Ç–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ –º–æ–±–∏–ª–µ
        requestAnimationFrame(() => {
          overlay.classList.add('overlay-fadeout');
          // –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞
          const removeOverlay = () => { try { overlay.remove(); } catch(_) {} };
          overlay.addEventListener('transitionend', removeOverlay, { once: true });
          // –§–æ–ª–±—ç–∫-—Ç–∞–π–º–µ—Ä –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
          setTimeout(removeOverlay, 550);
        });
      }

      // –ü–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏ ‚Äî —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –∑–∞—Ç–µ–º –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É (–ø–æ—è–≤–∏—Ç—Å—è –∏ –∏—Å—á–µ–∑–Ω–µ—Ç)
      setTimeout(() => {
        toDisperse.forEach(el => { try { el.remove(); } catch(_) {} });
        if (characterEl) {
          characterEl.style.display = 'block';
          // –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ —Ü–µ–Ω—Ç—Ä–µ –∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ
          characterEl.classList.add('character-pop');
          // –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ ‚Äî —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
          characterEl.addEventListener('animationend', () => {
            try { characterEl.remove(); } catch(_) {}
          }, { once: true });
        }
      }, 1000);
    }

    

    // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏
    function createConfetti() {
      const confetti = document.createElement('div');
      confetti.classList.add('confetti');
      confetti.style.left = Math.random() * 100 + 'vw';
      confetti.style.backgroundColor = ['red','yellow','white'][Math.floor(Math.random()*3)];
      confetti.style.animationDuration = (2 + Math.random() * 3) + 's';
      document.body.appendChild(confetti);
      setTimeout(() => confetti.remove(), 5000);
    }
    let confettiInterval = setInterval(createConfetti, isSmallScreen ? 600 : 300);

    // –°–∞–ª—é—Ç
    function createFirework(particles = 40, radiusMax = 220) {
      const x = Math.random() * window.innerWidth;
      const y = Math.random() * window.innerHeight * 0.5;

      for (let i = 0; i < particles; i++) {
        const firework = document.createElement('div');
        firework.classList.add('firework');
        firework.style.left = x + 'px';
        firework.style.top = y + 'px';
        firework.style.background = FIREWORK_COLORS[Math.floor(Math.random()*FIREWORK_COLORS.length)];

        const angle = Math.random() * 2 * Math.PI;
        const radius = Math.random() * radiusMax;
        const dx = Math.cos(angle) * radius;
        const dy = Math.sin(angle) * radius;

        // –ü–µ—Ä–µ–¥–∞—ë–º —Å–º–µ—â–µ–Ω–∏–µ –∏ —É–≥–æ–ª —á–µ—Ä–µ–∑ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ —Ö–≤–æ—Å—Ç–∞
        firework.style.setProperty('--dx', `${dx}px`);
        firework.style.setProperty('--dy', `${dy}px`);
        firework.style.setProperty('--angle', `${angle}rad`);
        // –î–ª–∏–Ω–∞ —Ö–≤–æ—Å—Ç–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –¥–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª—ë—Ç–∞
        firework.style.setProperty('--tail', `${Math.max(100, radius)}px`);

        document.body.appendChild(firework);
        setTimeout(() => firework.remove(), 1800);
      }
    }

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑—Ä—ã–≤–∞–º–∏ –ø–æ –º—É–∑—ã–∫–µ
    function stopMusicBooms() {
      if (musicFireworkInterval) { clearInterval(musicFireworkInterval); musicFireworkInterval = null; }
      if (musicBigBoomInterval) { clearInterval(musicBigBoomInterval); musicBigBoomInterval = null; }
    }

    // –ù–∞ —Å—Ç–∞—Ä—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏ —É—Å–∏–ª–∏–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É —Å–∞–ª—é—Ç–æ–≤
    fanfare.addEventListener('play', () => {
      // –û—Ç–∫–ª—é—á–∏–º –±–∞–∑–æ–≤—ã–π —Ç–∞–π–º–µ—Ä, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —á–∞—Å—Ç–∏—Ü
      if (fireworkInterval) { clearInterval(fireworkInterval); fireworkInterval = null; }

      stopMusicBooms();
      // –ù–µ–±–æ–ª—å—à–∏–µ —á–∞—Å—Ç—ã–µ –≤—Å–ø—ã—à–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ –≤ —Ç–∞–∫—Ç)
      musicFireworkInterval = setInterval(() => {
        createFirework(isSmallScreen ? 16 : 24, isSmallScreen ? 110 : 140);
        try { fireworkSound.currentTime = 0; fireworkSound.play().catch(()=>{}); } catch(_) {}
      }, isSmallScreen ? 1200 : 800);
      // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –±–æ–ª—å—à–∏–µ ¬´–∑–∞–ª–ø—ã¬ª
      musicBigBoomInterval = setInterval(() => {
        createFirework(isSmallScreen ? 50 : 80, isSmallScreen ? 200 : 280);
        try { fireworkSound.currentTime = 0; fireworkSound.play().catch(()=>{}); } catch(_) {}
      }, isSmallScreen ? 4200 : 3200);
    });

    // –ü—Ä–∏ –ø–∞—É–∑–µ/–æ–∫–æ–Ω—á–∞–Ω–∏–∏ ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –≤–∑—Ä—ã–≤—ã –∏ –≤–µ—Ä–Ω—É—Ç—å –±–∞–∑–æ–≤—ã–π —Ç–µ–º–ø
    fanfare.addEventListener('pause', () => {
      stopMusicBooms();
      if (!fireworkInterval) {
        fireworkInterval = setInterval(() => {
          createFirework();
          try { fireworkSound.currentTime = 0; fireworkSound.play().catch(()=>{}); } catch(_) {}
        }, isSmallScreen ? 6000 : 4000);
      }
    });
    fanfare.addEventListener('ended', () => {
      stopMusicBooms();
    });
  </script>
</body>
</html>
